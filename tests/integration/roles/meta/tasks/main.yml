---
- name: meta create
  clc_meta:
    state: present
    name: "{{ meta_name }}"
    description: "{{ meta_description }}"
    jobId: "{{ meta_job_id }}"
    executionId: "{{ meta_exec_id }}"
    referenceId: "{{ meta_ref_id }}"
    data:
      type: INSTANCE
      value: "{{ meta_instance_create }}"
  register: meta_create
- name: assert meta create
  assert:
    that:
      - meta_create.changed == True
      - meta_create.content.state == "created"

- name: meta update
  clc_meta:
    state: present
    name: "{{ meta_name }}"
    description: "{{ meta_description }}"
    jobId: "{{ meta_job_id }}"
    executionId: "{{ meta_exec_id }}"
    referenceId: "{{ meta_ref_id }}"
    data:
      type: INSTANCE
      value: "{{ meta_instance_update }}"
  register: meta_update
- name: assert meta update
  assert:
    that:
      - meta_update.changed == True
      - meta_update.content.state == "updated"

- name: meta_fact
  clc_meta_fact:
    name: "{{ meta_name }}"
    jobId: "{{ meta_job_id }}"
    executionId: "{{ meta_exec_id }}"
    referenceId: "{{ meta_ref_id }}"
  register: meta_fact
- name: assert meta_fact
  assert:
    that:
      - meta_fact.changed == False
      - meta_fact.content.data.metadata[0].data.value == "{{ meta_instance_update }}"