---
- name: modify_server cpu
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    cpu: 2
    state: present
    wait: True
  register: modify_server_cpu
- name: assert modify_server cpu
  assert:
    that:
      - modify_server_cpu.changed == True

- name: modify_server memory
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    memory: 2
    state: present
    wait: True
  register: modify_server_memory
- name: assert modify_server memory
  assert:
    that:
      - modify_server_memory.changed == True

- name: modify_server resources unchanged
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    cpu: 2
    memory: 2
    state: present
    wait: True
  register: modify_server_resources_unchanged
- name: assert modify_server resources unchanged
  assert:
    that:
      - modify_server_resources_unchanged.changed == False

- name: modify_server alert_policy
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    alert_policy_name: "{{ policy_name }}"
    state: present
    wait: True
  register: modify_server_alert_policy
- name: assert modify_server alert_policy
  assert:
    that:
      - modify_server_alert_policy.changed == True

- name: modify_server aa_policy
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    anti_affinity_policy_name: "{{ policy_name }}"
    state: present
    wait: True
  register: modify_server_aa_policy
- name: assert modify_server aa_policy
  assert:
    that:
      - modify_server_aa_policy.changed == True

- name: modify_server network
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    additional_network: "{{ network_list.networks[0].id }}"
    state: present
    wait: True
  register: modify_server_network

- name: modify_server policies unchanged
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    alert_policy_name: "{{ policy_name }}"
    anti_affinity_policy_name: "{{ policy_name }}"
    additional_network: "{{ network_list.networks[0].id }}"
    state: present
    wait: True
  register: modify_server_policies_unchanged
- name: assert modify_server policies unchanged
  assert:
    that:
      - modify_server_policies_unchanged.changed == False

- name: modify_server remove policies
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    alert_policy_name: "{{ policy_name }}"
    anti_affinity_policy_name: "{{ policy_name }}"
    additional_network: "{{ network_list.networks[0].id }}"
    state: absent
    wait: True
  register: modify_server_remove_policies
- name: assert modify_server remove policies
  assert:
    that:
      - modify_server_remove_policies.changed == True

- name: modify_server remove policies unchanged
  clc_modify_server:
    server_ids:
      - "{{ servers_fact.servers[-1].id }}"
    location: "{{ location }}"
    alert_policy_name: "{{ policy_name }}"
    anti_affinity_policy_name: "{{ policy_name }}"
    additional_network: "{{ network_list.networks[0].id }}"
    state: absent
    wait: True
  register: modify_server_remove_policies_unchanged
- name: assert modify_server remove policies unchanged
  assert:
    that:
      - modify_server_remove_policies_unchanged.changed == False
